# =========================================
# 解決策1（推奨）：SendActivityをシンプルなテキストに変更
# =========================================

kind: AdaptiveTopic
beginDialog:
  kind: OnRecognizedIntent
  id: main

  actions:
    # ===== ステップ1：入力内容の確認 =====
    - kind: AdaptiveCardPrompt
      id: QCt2gf
      variable: Topic.Confirm

      card:
        type: AdaptiveCard
        version: "1.5"
        $schema: "http://adaptivecards.io/schemas/adaptive-card.json"

        body:
          - type: TextBlock
            size: Medium
            weight: Bolder
            text: "ご入力内容の確認"

          - type: FactSet
            facts:
              - title: "相談区分"
                value: "${Topic.InquiryType}"
              - title: "部名"
                value: "${Topic.Department}"
              - title: "担当者名"
                value: "${Topic.PersonInCharge}"
              - title: "相談の概要"
                value: "${Topic.ConsultationSummary}"
              - title: "円貨/外貨"
                value: "${Topic.CurrencyType}"
              - title: "受取口座"
                value: "${Topic.ReceivingAccount}"
              - title: "処理予定日"
                value: "${if(empty(Topic.ScheduledDate), '', formatDateTime(Topic.ScheduledDate, 'yyyy-MM-dd'))}"

          - type: Input.ChoiceSet
            id: Confirm
            label: "最終確認"
            style: expanded
            isRequired: true
            errorMessage: "はい/いいえを選んでください。"
            choices:
              - title: "はい"
                value: "yes"
              - title: "いいえ（修正）"
                value: "no"

        actions:
          - type: Action.Submit
            title: "決定"

    # ===== ステップ2：完了通知（シンプルなテキストのみ）← 修正箇所 =====
    - kind: SendActivity
      id: send_completion
      activity:
        text: "入力内容を確認しました。処理を進めます。"
        # attachments を削除！
