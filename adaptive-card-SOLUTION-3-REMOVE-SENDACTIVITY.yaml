# =========================================
# 解決策3：SendActivityを完全に削除（最もシンプル）
# =========================================

kind: AdaptiveTopic
beginDialog:
  kind: OnRecognizedIntent
  id: main

  actions:
    # ===== ステップ1：入力内容の確認（これだけで完結）=====
    - kind: AdaptiveCardPrompt
      id: QCt2gf
      variable: Topic.Confirm

      card:
        type: AdaptiveCard
        version: "1.5"
        $schema: "http://adaptivecards.io/schemas/adaptive-card.json"

        body:
          - type: TextBlock
            size: Medium
            weight: Bolder
            text: "ご入力内容の確認"

          - type: FactSet
            facts:
              - title: "相談区分"
                value: "${Topic.InquiryType}"
              - title: "部名"
                value: "${Topic.Department}"
              - title: "担当者名"
                value: "${Topic.PersonInCharge}"
              - title: "相談の概要"
                value: "${Topic.ConsultationSummary}"
              - title: "円貨/外貨"
                value: "${Topic.CurrencyType}"
              - title: "受取口座"
                value: "${Topic.ReceivingAccount}"
              - title: "処理予定日"
                value: "${if(empty(Topic.ScheduledDate), '', formatDateTime(Topic.ScheduledDate, 'yyyy-MM-dd'))}"

          - type: Input.ChoiceSet
            id: Confirm
            label: "最終確認"
            style: expanded
            isRequired: true
            errorMessage: "はい/いいえを選んでください。"
            choices:
              - title: "はい"
                value: "yes"
              - title: "いいえ（修正）"
                value: "no"

        actions:
          - type: Action.Submit
            title: "決定"

    # SendActivityを削除したため、確認画面のみ表示される
    # 必要に応じて次のアクションを追加
